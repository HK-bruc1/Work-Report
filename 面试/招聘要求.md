# 招聘要求

## Free RTOS

1. USB协议？这个一般不都是通过USB转串口芯片实现通信吗？还有嵌入式设备直接通过USB通信？
   **答案**：嵌入式设备既可以通过USB转串口芯片（如CH340）实现串口通信，也可以直接使用MCU内置的USB外设（USB Device/Host/OTG）进行USB协议通信。FreeRTOS本身不提供USB协议栈，但可与第三方USB库（如TinyUSB）集成，在任务中处理USB数据传输。
2. 了解多进程多线程并发编程，以及进程间通信方式，freeRTOS中有这一些概念吗？
   **答案**：FreeRTOS支持多任务（即多线程）并发，但不支持进程（无内存隔离）。任务间通信方式包括：
   - **队列（Queue）**：传递数据块
   - **信号量（Semaphore）**：同步/资源计数
   - **互斥量（Mutex）**：共享资源互斥访问
   - **事件组（Event Group）**：任务间事件广播
   - **任务通知（Task Notification）**：轻量级信号/数据传递
   这些机制实现了类似进程间通信（IPC）的功能，但更轻量高效。

## 通信总线

> 📚 **详细文档**：[蓝牙协议栈详解.md](./蓝牙协议栈详解.md) | [ADC与DAC在嵌入式系统中的应用.md](./ADC与DAC在嵌入式系统中的应用.md) | [IIS在TWS耳机中的作用.md](./IIS在TWS耳机中的作用.md)

1. 蓝牙协议栈，对core spec以及profile有深入的了解
   **详解**：蓝牙协议栈是实现蓝牙功能的软件分层架构，按照蓝牙核心规范（Bluetooth Core Specification）分层设计：
   - **物理层**：2.4GHz RF，GFSK调制，79个信道（经典）或40个信道（BLE）
   - **基带层**：跳频扩频（FHSS），连接类型（SCO/eSCO/ACL）
   - **链路管理层（LMP）**：配对、加密、功率控制、角色切换
   - **主机控制器接口（HCI）**：主机与控制器间标准化接口（UART/USB）
   - **逻辑链路控制（L2CAP）**：协议多路复用、分段重组、QoS
   - **中间层协议**：RFCOMM（串口仿真）、SDP（服务发现）
   - **应用层Profile**：A2DP（音频）、AVRCP（控制）、HFP（免提）、SPP（串口）
   - **核心规范**：定义底层协议标准；**Profile**：定义应用实现规范
   - **TWS实现**：经典蓝牙负责音频，BLE负责控制通信，双模协同工作

2. ble通信协议
   **详解**：低功耗蓝牙（Bluetooth Low Energy）专为物联网设计，架构与经典蓝牙不同：
   - **物理层**：2.4GHz，1Mbps/2Mbps速率，40个2MHz信道
   - **链路层（LL）**：广播/扫描/连接状态，连接参数（间隔/延迟/超时）
   - **属性协议（ATT）**：客户端-服务器模型，基于属性操作
   - **通用属性协议（GATT）**：服务-特征值架构，定义数据交换格式
   - **关键特性**：
     - 极低功耗（纽扣电池数月/数年）
     - 快速连接建立（<10ms）
     - 广播模式（无需连接即可传输数据）
     - 数据速率较低（适合小数据包传输）
   - **TWS应用**：耳机盒通信、电量同步、佩戴检测、触控指令、固件升级控制

3. i2s协议
   **详解**：数字音频总线协议（Inter-IC Sound），专门传输PCM音频数据：
   - **信号线**：SCK（串行时钟）、WS（字选择/左右声道）、SD（串行数据）
   - **时序要求**：严格同步，μs级抖动容忍度，必须硬件实现
   - **工作模式**：主模式（生成时钟）/从模式（接收时钟）
   - **数据格式**：标准IIS、左对齐、右对齐、DSP模式
   - **TWS应用**：连接外部Codec芯片，实现高保真音质
   - **JL709N实现**：通过ALINK（Audio Link）硬件控制器实现，配置复杂（15+参数）
   - **成本权衡**：大多数TWS使用内部DAC（成本低），高端产品使用IIS+外部Codec（音质优）

4. 对BTcontronller host hci层有一定了解
   **详解**：HCI（Host Controller Interface）是蓝牙架构中的关键接口层：
   - **架构**：分隔蓝牙主机（软件栈）与控制器（硬件）
   - **传输层**：UART（115200/921600/3Mbps）、USB、SDIO
   - **数据包类型**：
     - 命令包（主机→控制器）：初始化、连接管理、参数配置
     - 事件包（控制器→主机）：状态通知、连接事件、错误报告
     - 数据包（双向）：ACL数据（异步）、SCO数据（同步）
   - **关键功能**：
     - 设备发现（Inquiry/Page）
     - 连接管理（建立/断开/角色切换）
     - 链路控制（功率控制、加密管理）
     - 测试与诊断
   - **JL709N实现**：`btstack_event.h`中的事件解析函数，`btcontroller_config.h`控制器配置

5. 通过air log 分析蓝牙相关问题
   **详解**：Air Log是抓取和分析蓝牙空中数据包的专业技术：
   - **抓取工具**：Ellisys、Frontline、nRF Sniffer、Wireshark+Ubertooth
   - **分析内容**：
     - 连接建立过程（Inquiry→Page→LMP协商→加密）
     - 音频传输质量（SCO链路、重传率、时钟同步）
     - 功耗模式（Sniff参数、Park模式、角色切换）
     - 安全机制（配对流程、密钥交换）
   - **常见问题诊断**：
     - 连接失败：设备状态错误、LMP拒绝、安全冲突
     - 音频断续：CRC错误、时钟漂移、干扰
     - 功耗异常：扫描间隔过短、未进入低功耗模式
   - **调试流程**：抓包→过滤→解码→分析→定位→验证

6. 对SPP以及BLE通信有一定的了解
   **详解**：两种不同的蓝牙通信方式：
   - **SPP（Serial Port Profile）**：
     - 基于经典蓝牙，虚拟RS-232串口
     - 协议栈：应用→SPP→RFCOMM→L2CAP→基带
     - 特点：稳定可靠、适合大数据量、功耗较高
     - 应用：传统设备控制、数据传输
   - **BLE通信**：
     - 基于低功耗蓝牙，GATT服务架构
     - 操作：读取、写入、通知、指示
     - 特点：低功耗、快速连接、小数据包、广播能力
     - 应用：物联网传感器、设备控制、状态同步
   - **TWS选择**：现代TWS多用BLE GATT而非SPP，因功耗低、连接快

7. ADC以及DAC
   **详解**：模拟与数字信号转换的关键组件：
   - **ADC（模数转换器）**：
     - 将模拟电压转换为数字值
     - 关键参数：分辨率（bits）、采样率（Hz）、SNR、ENOB、THD
     - 架构类型：SAR（逐次逼近）、Σ-Δ（高精度）、流水线（高速）
     - TWS应用：麦克风输入（通话、降噪）、传感器检测（触摸、温度）
   - **DAC（数模转换器）**：
     - 将数字值转换为模拟电压
     - 关键参数：分辨率、建立时间、动态范围、毛刺能量
     - 架构类型：电阻分压、R-2R梯形、Σ-Δ、PWM
     - TWS应用：音频输出，内部DAC vs 外部Codec选择
   - **TWS设计权衡**：
     - 成本优先：使用芯片内部DAC（SNR 85-90dB，THD 0.05-0.1%）
     - 音质优先：IIS+外部Codec（SNR 105-110dB，THD 0.001%，成本+$1.5-3.0）