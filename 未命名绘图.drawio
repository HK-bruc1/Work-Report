<mxfile host="Electron" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/27.0.5 Chrome/134.0.6998.205 Electron/35.3.0 Safari/537.36" version="27.0.5">
  <diagram name="第 1 页" id="6U1jPHZM0eQwhELqOTIP">
    <mxGraphModel dx="4277" dy="2965" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="jmCZlK9ZIKeDWJkmDi-t-9" value="" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.decision;whiteSpace=wrap;" parent="1" vertex="1">
          <mxGeometry x="70" y="20" width="100" height="100" as="geometry" />
        </mxCell>
        <mxCell id="jmCZlK9ZIKeDWJkmDi-t-12" value="决策判断" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="90" y="55" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="jmCZlK9ZIKeDWJkmDi-t-14" value="" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.start_1;whiteSpace=wrap;" parent="1" vertex="1">
          <mxGeometry x="430" y="40" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="jmCZlK9ZIKeDWJkmDi-t-15" value="开始与结束" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="450" y="57" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="jmCZlK9ZIKeDWJkmDi-t-16" value="" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.terminator;whiteSpace=wrap;" parent="1" vertex="1">
          <mxGeometry x="570" y="50" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="jmCZlK9ZIKeDWJkmDi-t-17" value="流程" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="590" y="65" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="jmCZlK9ZIKeDWJkmDi-t-18" value="实质的处理功能" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="260" y="22" width="100" height="100" as="geometry" />
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-1" value="开始" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="380" y="400" width="120" height="80" as="geometry" />
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-2" value="start_app启动耳机应用" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.terminator;whiteSpace=wrap;" parent="1" vertex="1">
          <mxGeometry x="390" y="554" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-3" value="" style="endArrow=classic;html=1;rounded=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="1" source="-3P-tr5u-usguAPoZ-Az-1" target="-3P-tr5u-usguAPoZ-Az-2" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="370" y="450" as="sourcePoint" />
            <mxPoint x="290" y="370" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-4" value="" style="endArrow=none;dashed=1;html=1;rounded=0;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="480" y="560" as="sourcePoint" />
            <mxPoint x="530" y="510" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-5" value="从app_main.c中的app_main函数开始" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="530" y="490" width="110" height="40" as="geometry" />
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-6" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.187;exitY=0.893;exitDx=0;exitDy=0;exitPerimeter=0;" parent="1" source="-3P-tr5u-usguAPoZ-Az-2" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="470" y="720" as="sourcePoint" />
            <mxPoint x="360" y="680" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-7" value="" style="endArrow=classic;html=1;rounded=0;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="470" y="614" as="sourcePoint" />
            <mxPoint x="520" y="680" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-8" value="状态机函数state_machine" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.terminator;whiteSpace=wrap;" parent="1" vertex="1">
          <mxGeometry x="280" y="680" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-9" value="事件处理函数event_handler" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.terminator;whiteSpace=wrap;" parent="1" vertex="1">
          <mxGeometry x="500" y="680" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-10" value="" style="endArrow=none;dashed=1;html=1;rounded=0;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="500" y="590" as="sourcePoint" />
            <mxPoint x="610" y="590" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-11" value="耳机应用通过app_earphone_ops结构体绑定了两个操作函数" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="610" y="560" width="110" height="60" as="geometry" />
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-12" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.11;exitY=0.89;exitDx=0;exitDy=0;exitPerimeter=0;" parent="1" source="-3P-tr5u-usguAPoZ-Az-8" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="140" y="810" as="sourcePoint" />
            <mxPoint x="240" y="800" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-13" value="进入APP_STA_START分支的ACTION_EARPHONE_MAIN分支" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.terminator;whiteSpace=wrap;" parent="1" vertex="1">
          <mxGeometry x="90" y="800" width="180" height="80" as="geometry" />
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-15" value="" style="endArrow=classic;html=1;rounded=0;exitX=0;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;" parent="1" source="-3P-tr5u-usguAPoZ-Az-13" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="70" y="980" as="sourcePoint" />
            <mxPoint x="40" y="920" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-17" value="" style="endArrow=none;dashed=1;html=1;rounded=0;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint y="840" as="sourcePoint" />
            <mxPoint x="80" y="840" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-18" value="&lt;div style=&quot;background-color: rgb(30, 30, 30); font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace; font-size: 16px; line-height: 22px; white-space: pre;&quot;&gt;蓝牙功能初始化&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="-90" y="825" width="80" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-20" value="" style="whiteSpace=wrap;html=1;aspect=fixed;" parent="1" vertex="1">
          <mxGeometry x="-90" y="920" width="130" height="130" as="geometry" />
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-21" value="bt_function_select_init&lt;br&gt;设置蓝牙连接参数；设置蓝牙连接超时参数；配对参数设置" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="-90" y="930" width="130" height="110" as="geometry" />
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-22" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;rounded=0;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-190" y="960" as="sourcePoint" />
            <mxPoint x="-100" y="960" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-23" value="设置最大连接设备数量（TCFG_BD_NUM定义）&lt;br&gt;；回连搜索超时时间；主机连接超时参数" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="-330" y="930" width="140" height="60" as="geometry" />
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-25" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.222;exitY=1;exitDx=0;exitDy=0;exitPerimeter=0;" parent="1" source="-3P-tr5u-usguAPoZ-Az-13" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="160" y="1040" as="sourcePoint" />
            <mxPoint x="140" y="920" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-27" value="" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="60" y="920" width="180" height="130" as="geometry" />
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-28" value="bredr_handle_register蓝牙事件处理注册：注册蓝牙快速测试接口（测试盒&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;）1.&lt;/span&gt;bt_fast_test_handle_register；注册蓝牙DUT模式2.bt_dut_test_handle_register" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="70" y="930" width="160" height="110" as="geometry" />
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-29" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.757;exitY=1.003;exitDx=0;exitDy=0;exitPerimeter=0;" parent="1" source="-3P-tr5u-usguAPoZ-Az-13" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="340" y="1060" as="sourcePoint" />
            <mxPoint x="320" y="920" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-30" value="" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="251" y="921" width="140" height="130" as="geometry" />
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-32" value="btstack_init：启动蓝牙协议栈，并开始运行蓝牙任务。这会最终触发蓝牙初始化完成事件。（源码不可见）" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="250" y="920" width="140" height="130" as="geometry" />
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-33" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.89;exitY=0.89;exitDx=0;exitDy=0;exitPerimeter=0;" parent="1" source="-3P-tr5u-usguAPoZ-Az-13" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="510" y="970" as="sourcePoint" />
            <mxPoint x="480" y="920" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-34" value="" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="400" y="920" width="140" height="130" as="geometry" />
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-35" value="set_bt_version：设置蓝牙版本；" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="410" y="930" width="120" height="110" as="geometry" />
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-36" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.89;exitY=0.89;exitDx=0;exitDy=0;exitPerimeter=0;" parent="1" source="-3P-tr5u-usguAPoZ-Az-13" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="500" y="870" as="sourcePoint" />
            <mxPoint x="640" y="920" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-37" value="" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="550" y="921" width="150" height="129" as="geometry" />
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-38" value="bt_sniff_feature_init：蓝牙低功耗模式，允许设备在保持连接时降低功耗" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="550" y="920" width="150" height="130" as="geometry" />
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-39" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.013;entryY=0.308;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="-3P-tr5u-usguAPoZ-Az-32" target="-3P-tr5u-usguAPoZ-Az-73" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="260" y="1150" as="sourcePoint" />
            <mxPoint x="820" y="1180" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-40" value="" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="-224" y="1490" width="224" height="90" as="geometry" />
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-41" value="当蓝牙初始化完成后，会触发BT_STATUS_INIT_OK事件，在bt_connction_status_event_handler函数中处理：" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="-220" y="1500" width="216" height="70" as="geometry" />
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-43" value="" style="endArrow=classic;html=1;rounded=0;exitX=0;exitY=1;exitDx=0;exitDy=0;" parent="1" source="-3P-tr5u-usguAPoZ-Az-40" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-224" y="1720" as="sourcePoint" />
            <mxPoint x="-284" y="1640" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-44" value="" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="-444" y="1641" width="170" height="59" as="geometry" />
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-45" value="bt_init_ok_search_index：初始化蓝牙设备搜索索引，用于快速回连历史设备。" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="-444" y="1641" width="170" height="60" as="geometry" />
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-47" value="" style="endArrow=classic;html=1;rounded=0;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-124" y="1582" as="sourcePoint" />
            <mxPoint x="-124" y="1641" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-48" value="处于BQB或PER测试模式" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.decision;whiteSpace=wrap;" parent="1" vertex="1">
          <mxGeometry x="-203" y="1641" width="160" height="139" as="geometry" />
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-49" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;rounded=0;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-114" y="1610" as="sourcePoint" />
            <mxPoint x="-24" y="1610" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-50" value="连接模式决策" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="-14" y="1590" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-51" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;exitPerimeter=0;" parent="1" source="-3P-tr5u-usguAPoZ-Az-48" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-114" y="1980" as="sourcePoint" />
            <mxPoint x="-123" y="1880" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-52" value="是" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="-114" y="1820" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-55" value="bt_wait_phone_connect_control(1)：开启可发现可连接状态。" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="-228" y="1880" width="210" height="100" as="geometry" />
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-56" value="" style="endArrow=classic;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;" parent="1" source="-3P-tr5u-usguAPoZ-Az-48" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="46" y="1780" as="sourcePoint" />
            <mxPoint x="86" y="1711" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-57" value="否" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="-4" y="1670" width="60" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-59" value="正常模式下，根据DAC电源状态，选择不同连接方式" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.decision;whiteSpace=wrap;" parent="1" vertex="1">
          <mxGeometry x="86" y="1625.5" width="180" height="170" as="geometry" />
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-60" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;exitPerimeter=0;" parent="1" source="-3P-tr5u-usguAPoZ-Az-59" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="186" y="1950" as="sourcePoint" />
            <mxPoint x="176" y="1880" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-61" value="app_var.wait_timer_do = sys_timeout_add(NULL, play_poweron_ok_timer, 100);延迟100ms后执行连接操作" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="101" y="1880" width="150" height="100" as="geometry" />
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-62" value="DAC电源工作时" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="191" y="1830" width="105" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-63" value="" style="endArrow=classic;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" target="-3P-tr5u-usguAPoZ-Az-67" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="270" y="1710.5" as="sourcePoint" />
            <mxPoint x="350" y="1710" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-64" value="TWS双耳模式下：执行bt_tws_poweron该函数会处理双耳间的同步连接逻辑" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="727.5" y="1895" width="140" height="80" as="geometry" />
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-65" value="DAC电源关闭时" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="260" y="1670" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-67" value="是否使能TWS模式" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.decision;whiteSpace=wrap;" parent="1" vertex="1">
          <mxGeometry x="487.5" y="1870" width="130" height="130" as="geometry" />
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-68" value="" style="endArrow=classic;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="-3P-tr5u-usguAPoZ-Az-67" target="-3P-tr5u-usguAPoZ-Az-64" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="627.5" y="2104.5" as="sourcePoint" />
            <mxPoint x="677.5" y="2054.5" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-69" value="使能即为双耳模式" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="617.5" y="1895.5" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-70" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.553;entryY=0.002;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="-3P-tr5u-usguAPoZ-Az-67" target="-3P-tr5u-usguAPoZ-Az-72" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="607.5" y="2114.5" as="sourcePoint" />
            <mxPoint x="552.5" y="2094.5" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-71" value="不使能TWS,单耳模式：启动连接流程" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="557.5" y="2020" width="100" height="51" as="geometry" />
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-72" value="bt_wait_connect_and_phone_connect_switch(0);&lt;br&gt;参数0表示主动连接记忆设备，发起蓝牙连接请求" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="407.5" y="2104.5" width="265" height="100" as="geometry" />
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-73" value="蓝牙连接状态处理函数：bt_connction_status_event_handler" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.terminator;whiteSpace=wrap;" parent="1" vertex="1">
          <mxGeometry x="840" y="1160" width="230" height="130" as="geometry" />
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-74" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.11;exitY=0.89;exitDx=0;exitDy=0;exitPerimeter=0;" parent="1" source="-3P-tr5u-usguAPoZ-Az-73" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1030" y="1410" as="sourcePoint" />
            <mxPoint x="10" y="1490" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-75" value="触发BT_STATUS_INIT_OK分支" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="250" y="1340" width="180" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-78" value="" style="endArrow=classic;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="-3P-tr5u-usguAPoZ-Az-61" target="-3P-tr5u-usguAPoZ-Az-67" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="320" y="1960" as="sourcePoint" />
            <mxPoint x="370" y="1910" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-79" value="延迟后再走这个流程" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="290" y="1900" width="130" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-80" value="直接走这个流程" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="390" y="1760" width="122" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-81" value="" style="endArrow=none;html=1;rounded=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" parent="1" target="-3P-tr5u-usguAPoZ-Az-72" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="540" y="2310" as="sourcePoint" />
            <mxPoint x="440" y="2280" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-83" value="" style="endArrow=none;html=1;rounded=0;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="540" y="2310" as="sourcePoint" />
            <mxPoint x="720" y="2310" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-85" value="" style="endArrow=none;html=1;rounded=0;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="720" y="2310" as="sourcePoint" />
            <mxPoint x="720" y="2160" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-86" value="" style="endArrow=classic;html=1;rounded=0;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="720" y="2160" as="sourcePoint" />
            <mxPoint x="680" y="2160" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-87" value="利用定时器重复执行" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="570" y="2270" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-89" value="开机时持续尝试记忆设备连接；连接失败后自动切换到可发现模式；" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="275" y="2031" width="105" height="79" as="geometry" />
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-90" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;rounded=0;exitX=1.039;exitY=0.64;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0;entryY=0;entryDx=0;entryDy=0;" parent="1" source="-3P-tr5u-usguAPoZ-Az-89" target="-3P-tr5u-usguAPoZ-Az-72" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="420" y="2070" as="sourcePoint" />
            <mxPoint x="470" y="2020" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-91" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;rounded=0;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="870" y="1930" as="sourcePoint" />
            <mxPoint x="940" y="1930" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-92" value="后面是TWS连接流程？" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="910" y="1899" width="90" height="30" as="geometry" />
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-94" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;rounded=0;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="-290" y="1540" as="sourcePoint" />
            <mxPoint x="-230" y="1540" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-95" value="bt_connction_status_event_handler在event_handler中被调用，在SYS_BT_EVENT分支" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="-500" y="1505" width="210" height="60" as="geometry" />
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-97" value="状态机的APP_STA_START流程执行完毕" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="440" y="1130" width="150" height="70" as="geometry" />
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-101" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.89;exitY=0.89;exitDx=0;exitDy=0;exitPerimeter=0;entryX=0.204;entryY=0;entryDx=0;entryDy=0;entryPerimeter=0;" parent="1" source="-3P-tr5u-usguAPoZ-Az-9" target="-3P-tr5u-usguAPoZ-Az-73" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="890" y="830" as="sourcePoint" />
            <mxPoint x="940" y="780" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-102" value="主要关注蓝牙事件的处理：SYS_BT_EVENT分支" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="770" y="900" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-103" value="bt_hci_event_handler" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.terminator;whiteSpace=wrap;" parent="1" vertex="1">
          <mxGeometry x="1210" y="1160" width="230" height="130" as="geometry" />
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-104" value="" style="endArrow=classic;html=1;rounded=0;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="800" y="1040" as="sourcePoint" />
            <mxPoint x="1320" y="1150" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-106" value="当手机发起连接请求时，会触发HCI事件，在bt_hci_event_handler函数中处理：" style="text;html=1;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
          <mxGeometry x="1220" y="770" width="190" height="60" as="geometry" />
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-107" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;rounded=0;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1320" y="840" as="sourcePoint" />
            <mxPoint x="1320" y="1040" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="-3P-tr5u-usguAPoZ-Az-108" value="" style="endArrow=classic;html=1;rounded=0;" parent="1" edge="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="1320" y="1040" as="sourcePoint" />
            <mxPoint x="1320" y="1140" as="targetPoint" />
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
